<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>

<title>MCQ PDF Final (Hindi Perfect)</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Kalam:wght@400;700&family=Noto+Sans+Devanagari:wght@400;600&display=swap" rel="stylesheet">

<!-- libs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

body{
  background:#0f172a;
  color:#fff;
  font-family:'Noto Sans Devanagari';
  margin:20px;
}

textarea,input{
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:8px;
  background:#111;
  color:#fff;
  border:1px solid #333;
}

button{
  padding:8px 12px;
  border:none;
  border-radius:8px;
  margin:4px;
  cursor:pointer;
  font-weight:bold;
}

.blue{background:#0b74ff}
.green{background:#10b981}
.orange{background:#f59e0b}

.preview{
  margin-top:15px;
}

/* ===== PDF PAGE LAYOUT ===== */

.page{
  width:794px; /* A4 */
  height:1123px;
  background:#fff;
  color:#000;
  margin:15px auto;
  padding:40px;
  display:grid;
  grid-template-columns:1fr 1fr; /* LEFT RIGHT */
  gap:25px;
  font-family:'Noto Sans Devanagari';
}

.qbox{
  font-size:15px;
  line-height:1.4;
}

.divider{
  grid-column:1/3;
  height:2px;
  background:#333;
  margin:10px 0;
}

.exp{
  border:2px solid #000;
  border-radius:12px;
  padding:6px;
  margin-top:6px;
}

.ans{
  font-weight:bold;
  margin-top:4px;
}

</style>
</head>

<body>

<h2>MCQ PDF Generator (Hindi Perfect)</h2>

<textarea id="jsonArea" rows="5" placeholder="JSON paste here"></textarea>

<button class="orange" onclick="importJSON()">Import JSON</button>
<button class="blue" onclick="translateAll()">Translate</button>
<button class="green" onclick="generatePDF()">Generate PDF</button>

<div id="preview" class="preview"></div>

<script>

const { jsPDF } = window.jspdf;

let DATA=[];


// ------------ IMPORT JSON ------------
function importJSON(){
  DATA = JSON.parse(jsonArea.value);
  render();
}


// ------------ GOOGLE TRANSLATE ------------
async function translate(t){
  const r=await fetch(
  `https://translate.googleapis.com/translate_a/single?client=gtx&sl=hi&tl=en&dt=t&q=${encodeURIComponent(t)}`
  );
  const d=await r.json();
  return d[0].map(x=>x[0]).join("");
}

async function translateAll(){
  for(let q of DATA){
    q.eng={};
    q.eng.question=await translate(q.question);
    q.eng.options=[];
    for(let o of q.options)
      q.eng.options.push(await translate(o));
  }
  alert("Translated âœ“");
}


// ------------ PREVIEW RENDER ------------
function render(){

  preview.innerHTML="";

  let page=createPage();
  preview.appendChild(page);

  let count=0;

  DATA.forEach((item,i)=>{

    if(count==6){ // 6 questions per page
      page=createPage();
      preview.appendChild(page);
      count=0;
    }

    const div=document.createElement("div");
    div.className="qbox";

    div.innerHTML=`
<b>Q${i+1}. ${item.question}</b><br>
A. ${item.options[0]}<br>
B. ${item.options[1]}<br>
C. ${item.options[2]}<br>
D. ${item.options[3]}

<div class="divider"></div>

<div class="exp">Explanation: ${item.exp}</div>
<div class="ans">Answer: ${item.answer}</div>

<br>
<i>${item.eng?.question || ""}</i>
`;

    page.appendChild(div);
    count++;
  });
}


function createPage(){
  const d=document.createElement("div");
  d.className="page";
  return d;
}


// ------------ PDF GENERATE ------------
async function generatePDF(){

  const pages=document.querySelectorAll(".page");

  const pdf=new jsPDF('p','px',[794,1123]);

  for(let i=0;i<pages.length;i++){

    const canvas=await html2canvas(pages[i]);

    const img=canvas.toDataURL("image/png");

    if(i>0) pdf.addPage();

    pdf.addImage(img,'PNG',0,0,794,1123);
  }

  pdf.save("MCQ_Final.pdf");
}

</script>

</body>
</html>
