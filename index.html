<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<title>MCQ → PDF Generator (Hindi + English)</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  font-family: Arial;
  background:#0f1720;
  color:#fff;
  margin:20px;
}

textarea,input{
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:8px;
  border:1px solid #333;
  background:#111;
  color:#fff;
}

button{
  padding:10px 14px;
  border:none;
  border-radius:8px;
  margin:6px;
  cursor:pointer;
  font-weight:bold;
}

.blue{background:#0b74ff}
.green{background:#059669}
.red{background:#e11d48}

.preview{
  background:#111;
  padding:10px;
  margin-top:10px;
  border-radius:10px;
  max-height:450px;
  overflow:auto;
}

.card{
  background:#1b2332;
  padding:10px;
  margin-bottom:10px;
  border-radius:10px;
}
hr{border-color:#333}
</style>
</head>

<body>

<h2>MCQ → PDF Generator</h2>

<textarea id="q" placeholder="Question (Hindi)"></textarea>
<input id="o1" placeholder="Option 1">
<input id="o2" placeholder="Option 2">
<input id="o3" placeholder="Option 3">
<input id="o4" placeholder="Option 4">
<textarea id="exp" placeholder="Explanation"></textarea>

<button class="green" onclick="add()">Add Question</button>
<button class="blue" onclick="generatePDF()">Generate PDF</button>
<button class="red" onclick="clearAll()">Clear</button>

<div class="preview" id="preview"></div>

<script>

const { jsPDF } = window.jspdf;

let DATA=[];

// Google Translate API
async function translate(text){
  const url=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=hi&tl=en&dt=t&q=${encodeURIComponent(text)}`;
  const r=await fetch(url);
  const d=await r.json();
  return d[0].map(x=>x[0]).join("");
}

function add(){

  DATA.push({
    question:q.value,
    options:[o1.value,o2.value,o3.value,o4.value],
    exp:exp.value
  });

  q.value=o1.value=o2.value=o3.value=o4.value=exp.value="";
  render();
}

function render(){

  preview.innerHTML="";

  DATA.forEach((item,i)=>{

    const div=document.createElement("div");
    div.className="card";
    div.contentEditable=true;

    div.innerText=
`Q${i+1}. ${item.question}

1. ${item.options[0]}
2. ${item.options[1]}
3. ${item.options[2]}
4. ${item.options[3]}

Explanation: ${item.exp}`;

    div.onblur=()=>{
      DATA[i].question=div.innerText;
    };

    preview.appendChild(div);
  });
}

async function generatePDF(){

  if(DATA.length===0) return alert("Add questions first");

  const pdf=new jsPDF();

  for(let i=0;i<DATA.length;i++){

    let item=DATA[i];

    const engQ=await translate(item.question);
    const engOpts=[];
    for(let o of item.options){
      engOpts.push(await translate(o));
    }

    let y=20;

    pdf.setFontSize(14);

    // Hindi Question
    pdf.text(`Q${i+1}. ${item.question}`,20,y);
    y+=10;

    item.options.forEach((o,j)=>{
      pdf.text(`${j+1}. ${o}`,25,y);
      y+=8;
    });

    // separator
    y+=4;
    pdf.line(20,y,190,y);
    y+=10;

    // explanation rounded box
    pdf.roundedRect(20,y,170,25,5,5);
    pdf.text("Explanation:",25,y+8);
    pdf.text(item.exp,25,y+16);

    y+=40;

    // English Section
    pdf.text(`English Version:`,20,y);
    y+=10;

    pdf.text(engQ,20,y);
    y+=10;

    engOpts.forEach((o,j)=>{
      pdf.text(`${j+1}. ${o}`,25,y);
      y+=8;
    });

    if(i!==DATA.length-1) pdf.addPage();
  }

  pdf.save("MCQ_Final.pdf");
}

function clearAll(){
  DATA=[];
  render();
}

</script>
</body>
</html>
