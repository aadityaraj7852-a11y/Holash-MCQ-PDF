<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<title>MCQ PDF Pro Generator</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Kalam:wght@400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

body{
  font-family:'Poppins',sans-serif;
  background:#0f172a;
  color:#fff;
  margin:20px;
}

h2{
  font-family:'Kalam';
  text-align:center;
  font-size:30px;
  color:#ffd54f;
}

.card{
  background:#172033;
  padding:16px;
  border-radius:12px;
  margin-bottom:15px;
}

textarea,input{
  width:100%;
  padding:8px;
  border-radius:8px;
  border:1px solid #2e3b55;
  background:#0b1220;
  color:#fff;
  margin-top:6px;
}

button{
  padding:9px 14px;
  border:none;
  border-radius:8px;
  margin:6px 4px;
  font-weight:600;
  cursor:pointer;
}

.blue{background:#0b74ff}
.green{background:#10b981}
.orange{background:#f59e0b}
.red{background:#ef4444}

.preview{
  max-height:420px;
  overflow:auto;
  margin-top:10px;
}

.qbox{
  background:#0b1220;
  padding:10px;
  border-radius:10px;
  margin-bottom:10px;
  font-family:'Kalam';
  white-space:pre-wrap;
  border:1px solid #2e3b55;
}

.qbox[contenteditable]{
  outline:1px dashed #555;
}

</style>
</head>

<body>

<h2>MCQ PDF Pro Generator</h2>

<div class="card">

<textarea id="jsonArea" rows="5" placeholder="JSON paste here..."></textarea>

<button class="orange" onclick="importJSON()">Import JSON</button>
<button class="green" onclick="add()">Add Manual</button>
<button class="blue" onclick="translateAll()">Translate</button>
<button class="blue" onclick="generatePDF()">Generate PDF</button>
<button class="red" onclick="clearAll()">Clear</button>

<hr>

<textarea id="q" placeholder="Question (Hindi)"></textarea>
<input id="o1" placeholder="Option A">
<input id="o2" placeholder="Option B">
<input id="o3" placeholder="Option C">
<input id="o4" placeholder="Option D">
<input id="ans" placeholder="Answer (A/B/C/D)">
<textarea id="exp" placeholder="Explanation"></textarea>

</div>

<div class="preview" id="preview"></div>

<script>

const { jsPDF } = window.jspdf;
let DATA=[];


// -------- GOOGLE TRANSLATE -----------
async function translate(text){
  const url=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=hi&tl=en&dt=t&q=${encodeURIComponent(text)}`;
  const r=await fetch(url);
  const d=await r.json();
  return d[0].map(x=>x[0]).join("");
}


// ---------- ADD MANUAL ----------
function add(){

  DATA.push({
    question:q.value,
    options:[o1.value,o2.value,o3.value,o4.value],
    answer:ans.value,
    exp:exp.value,
    eng:{}
  });

  q.value=o1.value=o2.value=o3.value=o4.value=ans.value=exp.value="";
  render();
}


// ---------- JSON IMPORT ----------
function importJSON(){
  try{
    const j=JSON.parse(jsonArea.value);
    DATA=j;
    render();
  }catch{
    alert("Invalid JSON");
  }
}


// ---------- PREVIEW ----------
function render(){

  preview.innerHTML="";

  DATA.forEach((item,i)=>{

    const div=document.createElement("div");
    div.className="qbox";
    div.contentEditable=true;

    div.innerText=
`Q${i+1}. ${item.question}

A. ${item.options[0]}
B. ${item.options[1]}
C. ${item.options[2]}
D. ${item.options[3]}

Ans: ${item.answer}

Explanation: ${item.exp}`;

    preview.appendChild(div);
  });
}


// ---------- TRANSLATE BUTTON ----------
async function translateAll(){

  for(let item of DATA){

    item.eng.question=await translate(item.question);

    item.eng.options=[];
    for(let o of item.options)
      item.eng.options.push(await translate(o));
  }

  alert("Translated âœ“");
}


// ---------- PDF GENERATE ----------
async function generatePDF(){

  const pdf=new jsPDF();
  pdf.setFont("helvetica");

  for(let i=0;i<DATA.length;i++){

    let d=DATA[i];

    let y=20;

    pdf.setFontSize(14);

    // Hindi
    pdf.text(`Q${i+1}. ${d.question}`,15,y); y+=10;

    d.options.forEach((o,j)=>{
      pdf.text(`${"ABCD"[j]}. ${o}`,20,y); y+=8;
    });

    // Divider Line
    y+=5;
    pdf.line(10,y,200,y);

    // Explanation Box
    y+=10;
    pdf.roundedRect(12,y,186,20,5,5);
    pdf.text("Explanation:",16,y+7);
    pdf.text(d.exp,16,y+15);

    // Answer
    y+=30;
    pdf.text(`Answer: ${d.answer}`,15,y);

    // English
    if(d.eng?.question){
      y+=15;
      pdf.text("English Version:",15,y); y+=10;

      pdf.text(d.eng.question,15,y); y+=10;

      d.eng.options.forEach((o,j)=>{
        pdf.text(`${"ABCD"[j]}. ${o}`,20,y); y+=8;
      });
    }

    if(i!=DATA.length-1) pdf.addPage();
  }

  pdf.save("MCQ_Final.pdf");
}


// ---------- CLEAR ----------
function clearAll(){
  DATA=[];
  preview.innerHTML="";
}

</script>
</body>
</html>
